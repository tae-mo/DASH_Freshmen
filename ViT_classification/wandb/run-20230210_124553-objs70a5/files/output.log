
Start from epoch:0















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10010/10010 [2:01:27<00:00,  1.37it/s, accuracy=14.8, loss=3.51]

  0%|▎                                                                                                                                                | 1/391 [00:02<17:17,  2.66s/it, accuracy=46.9, loss=2.86]
Traceback (most recent call last):
  File "main___.py", line 126, in <module>
    main(rank=local_rank, batch_size=args.batch_size, world_size=dist.get_world_size())
  File "main___.py", line 96, in main
    test_loss, test_accuracy = validation.test_fn(test_loader, model, criterion, rank)
  File "/home/syon1203/DASH_Freshmen/ViT_classification/validation.py", line 15, in test_fn
    out = model(x)
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 886, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/syon1203/DASH_Freshmen/ViT_classification/model.py", line 189, in forward
    x = block(x)  # (n_samples, 577, 768)
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/syon1203/DASH_Freshmen/ViT_classification/model.py", line 120, in forward
    x = x + self.mlp(self.norm2(x))
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/syon1203/DASH_Freshmen/ViT_classification/model.py", line 91, in forward
    x = self.act(x) #n_samples , n_patches+1 , hidden_features
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 652, in forward
    return F.gelu(input)
  File "/home/syon1203/anaconda3/envs/classification/lib/python3.8/site-packages/torch/nn/functional.py", line 1556, in gelu
    return torch._C._nn.gelu(input)
RuntimeError: CUDA out of memory. Tried to allocate 148.00 MiB (GPU 0; 23.65 GiB total capacity; 20.36 GiB already allocated; 52.44 MiB free; 20.81 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF